<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Addition Game â€” Big Calculator</title>
  <style>
    :root {
      --bg-color: #ffe4f2;
      --text: #4a0033;
      --muted: #b8649b;
      --accent2: #ff8acb;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg-color: #1a1a1c;
        --text: #fce7f3;
        --muted: #d192bc;
      }
    }

    html, body {
      height: 100%;
      margin: 0;
      font-family: Inter, ui-sans-serif, system-ui, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background-color: var(--bg-color); /* Theme-based solid background */
      color: var(--text);
      transition: background-color 0.3s ease;
    }

    .wrap { min-height: 100%; display: flex; align-items: center; justify-content: center; padding: 24px; }

    .game {
      width: 560px;
      max-width: 96vw;
      /* Opaque background prevents the dark theme from showing through */
      background: #ffffff;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(0, 0, 0, 0.06);
      position: relative;
    }

    /* Fixed colors inside the panel so they don't change with dark mode */
    .screen {
      background: linear-gradient(180deg, #fff4fb, #ffeaf6);
      border-radius: 12px;
      padding: 18px;
      color: #4a0033;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 14px;
      border: 1px solid rgba(0,0,0,0.04);
    }
    .problem { font-size: 32px; font-weight: 800; color: #ff8acb; }
    .display { background: #ffffff; padding: 12px 16px; border-radius: 10px; min-width: 160px; text-align: right; font-size: 32px; font-weight: 800; color: #4a0033; box-shadow: inset 0 -6px 12px rgba(0,0,0,0.04); }
    .sub { font-size: 13px; color: #b8649b; }

    .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 4px; }
    .btn { background: linear-gradient(180deg, #ffd7ee, #ffc6ea); border-radius: 12px; padding: 18px; font-size: 28px; text-align: center; cursor: pointer; user-select: none; border: 1px solid rgba(0,0,0,0.06); box-shadow: 0 6px 10px rgba(0,0,0,0.04); color: #4a0033; }
    .btn:active { transform: translateY(2px); }
    .controls { display: flex; gap: 8px; align-items: center; margin-top: 12px; }
    .small { font-size: 14px; padding: 8px 12px; border-radius: 8px; background: linear-gradient(180deg,#ffdff3,#ffd3ec); border: 1px solid rgba(0,0,0,0.04); cursor: pointer; color: #4a0033; }
    .status { margin-top: 10px; height: 28px; }

    canvas#fireworks { position: fixed; left: 0; top: 0; pointer-events: none; z-index: 60; }
    @media (max-width: 520px) { .game { padding: 14px; } .btn { padding: 14px; font-size: 22px; } .display { font-size: 24px; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="game" role="application" aria-label="Addition game">
      <div class="screen">
        <div>
          <div class="problem" id="problem">3 + 4</div>
          <div class="sub">Add the two numbers. Answers usually under 20.</div>
        </div>
        <div>
          <div class="display" id="answerDisplay">?</div>
          <div class="sub" style="text-align:right">Use keyboard then =</div>
        </div>
      </div>

      <div class="keypad" id="keypad">
        <div class="btn" data-key="7">7</div><div class="btn" data-key="8">8</div><div class="btn" data-key="9">9</div>
        <div class="btn" data-key="4">4</div><div class="btn" data-key="5">5</div><div class="btn" data-key="6">6</div>
        <div class="btn" data-key="1">1</div><div class="btn" data-key="2">2</div><div class="btn" data-key="3">3</div>
        <div class="btn" data-key="0">0</div><div class="btn" id="clear">C</div><div class="btn" id="enter">=</div>
      </div>

      <div class="controls">
        <button class="small" id="newProblem">New problem</button>
        <button class="small" id="showAnswer">Show answer</button>
        <div style="flex:1"></div>
        <div class="sub">Correct: <span id="score">0</span></div>
      </div>
      <div class="status" id="status" aria-live="polite"></div>
      <canvas id="fireworks"></canvas>
    </div>
  </div>

  <script>
    const problemEl = document.getElementById('problem');
    const displayEl = document.getElementById('answerDisplay');
    const statusEl = document.getElementById('status');
    const scoreEl = document.getElementById('score');
    const canvas = document.getElementById('fireworks');
    const ctx = canvas.getContext('2d');

    let current = '';
    let a = 3, b = 4, score = 0;

    function resizeCanvas(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function pickProblem(){
      a = Math.floor(Math.random() * 10);
      b = Math.floor(Math.random() * (20 - a));
      if(a === 0 && b === 0) b = 1;
      problemEl.textContent = `${a} + ${b}`;
      current = '';
      updateDisplay();
      status('', false);
    }

    function updateDisplay(){ displayEl.textContent = current === '' ? '?' : current; }
    function appendDigit(d){ if(current.length < 2) current = (current === '0') ? d : current + d; updateDisplay(); }
    function clearEntry(){ current=''; updateDisplay(); }
    function enter(){
      if(current === '') return;
      if(parseInt(current, 10) === a + b){ score++; scoreEl.textContent = score; status('Correct!'); launchFireworks(); setTimeout(pickProblem, 1200); }
      else { status('Try again.', true); shakeDisplay(); }
    }
    function status(msg, isError){ statusEl.textContent = msg; statusEl.style.color = isError ? '#c92a6d' : '#ff8acb'; }

    document.getElementById('keypad').addEventListener('click', (e)=>{
      const btn = e.target.closest('.btn');
      if(!btn) return;
      if(btn.dataset.key) appendDigit(btn.dataset.key);
      else if(btn.id === 'clear') clearEntry();
      else if(btn.id === 'enter') enter();
    });

    document.getElementById('newProblem').addEventListener('click', pickProblem);
    document.getElementById('showAnswer').addEventListener('click', ()=> status(`Answer: ${a + b}`, false));

    window.addEventListener('keydown',(e)=>{
      if(e.key >= '0' && e.key <= '9') appendDigit(e.key);
      else if(e.key === 'Enter') enter();
      else if(e.key === 'Backspace') clearEntry();
    });

    function shakeDisplay(){ displayEl.animate([{transform:'translateX(-10px)'},{transform:'translateX(10px)'},{transform:'translateX(0)'}],{duration:300}); }

    let particles = [];
    function launchFireworks(){
      for(let i=0; i<50; i++){
        particles.push({x: canvas.width/2, y: canvas.height/2, vx: Math.random()*6-3, vy: Math.random()*6-3, life: 100, color: '#ff8acb'});
      }
    }
    function step(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particles.forEach((p, i) => {
        p.x += p.vx; p.y += p.vy; p.life--;
        ctx.fillStyle = p.color; ctx.globalAlpha = p.life/100;
        ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
        if(p.life <= 0) particles.splice(i, 1);
      });
      requestAnimationFrame(step);
    }
    step(); pickProblem();
  </script>
</body>
</html>